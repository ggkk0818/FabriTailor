<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>FabriTailor</title>
    <link href="css/animate.css" rel="stylesheet" />
    <link href="css/style.css" rel="stylesheet" />
    <link href="css/account.css" rel="stylesheet" />
    <link href="css/accountBuild.css" rel="stylesheet" />
    <script src="js/modernizr.js"></script>
    <script src="js/jquery-1.11.3.min.js"></script>
    <script src="js/jquery.easing.1.3.js"></script>
    <script src="js/jquery.alert.js"></script>
    <script src="js/jquery.cookie.js"></script>
    <script src="js/jquery.lazyload.js"></script>
    <script src="js/common.js"></script>
</head>
<body>
    <header>
        <div class="header-container">
            <a class="menu-btn show-on-small" href="javascript:void(0);"><img src="img/menu-btn.png" /></a>
            <div class="logo">
                <img src="img/logo.png" />
            </div>
            <nav class="hide-on-small">
                <ul>
                    <li><a href="javascript:void(0);"><span>在线定制</span></a></li>
                    <li><a href="javascript:void(0);"><span>关于我们</span></a></li>
                    <li><a href="javascript:void(0);"><span>凡布风尚</span></a></li>
                    <li><a href="javascript:void(0);"><span>休闲衬衫</span></a></li>
                    <li><a href="javascript:void(0);"><span>我们的凡布</span></a></li>
                </ul>
            </nav>
            <div class="btn-group hide-on-small">
                <a href="javascript:void(0);" class="register">从这里开始</a><a href="javascript:void(0);" class="login">登录</a>
            </div>
        </div>
    </header>
    <aside class="show-on-small">
        <a href="javascript:void(0);" class="btn-close"><img src="img/menu-btn-close.png" /></a>
        <ul>
            <li><a href="javascript:void(0);"><span>在线定制</span></a></li>
            <li><a href="javascript:void(0);"><span>关于我们</span></a></li>
            <li><a href="javascript:void(0);"><span>凡布风尚</span></a></li>
            <li><a href="javascript:void(0);"><span>休闲衬衫</span></a></li>
            <li><a href="javascript:void(0);"><span>我们的凡布</span></a></li>
            <li><a class="button" href="javascript:void(0);">从这里开始</a></li>
        </ul>
    </aside>
    <div class="main-container clearfix">
        <div class="account-aside">
            <div class="current">我的版型<i class="showhide"></i></div>
            <ul>
                <li><a href="javascript:void(0);">账户信息</a></li>
                <li><a href="javascript:void(0);">我的订单</a></li>
                <li><a href="javascript:void(0);">我的尺寸</a></li>
                <li class="active"><a href="javascript:void(0);">我的版型</a></li>
                <li><a href="javascript:void(0);">分享与学习</a></li>
                <li><a href="javascript:void(0);">地址簿</a></li>
                <li><a href="javascript:void(0);">退换货</a></li>
            </ul>
            <a href="javascript:void(0);" class="sign-out">退出</a>
        </div>
        <div class="account-container">
            <div class="accountBuild">
                <h1>我的版型</h1>
                <p>你可以点击任意部分查看和修改你的专属版型，以便在购物时一键应用于你选购的衬衫。除此之外，你也可以在购物时新建一个只应用于一款衬衫的临时版型。</p>
                <div class="customization clearfix">
                    <div class="options">
                        <div class="option" data-specification-id="name1" data-specification-value="value1">
                            <div class="image"><img src="img/product-customizztion1.jpg" /></div>
                            <div class="text"><span>直筒型</span><i class="edit"></i></div>
                        </div>
                        <div class="option">
                            <div class="image"><img src="img/product-customizztion2.jpg" /></div>
                            <div class="text"><span>直筒型</span><i class="edit"></i></div>
                        </div>
                        <div class="option">
                            <div class="image"><img src="img/product-customizztion3.jpg" /></div>
                            <div class="text"><span>直筒型</span><i class="edit"></i></div>
                        </div>
                        <div class="option">
                            <div class="image"><img src="img/product-customizztion4.jpg" /></div>
                            <div class="text"><span>直筒型</span><i class="edit"></i></div>
                        </div>
                        <div class="option">
                            <div class="image"><img src="img/product-customizztion5.jpg" /></div>
                            <div class="text"><span>直筒型</span><i class="edit"></i></div>
                        </div>
                        <div class="option">
                            <div class="image"><img src="img/product-customizztion6.jpg" /></div>
                            <div class="text"><span>直筒型</span><i class="edit"></i></div>
                        </div>
                        <div class="option">
                            <div class="image"><img src="img/product-customizztion7.jpg" /></div>
                            <div class="text"><span>直筒型</span><i class="edit"></i></div>
                        </div>
                        <div class="option">
                            <div class="image"><img src="img/product-customizztion8.jpg" /></div>
                            <div class="text"><span>直筒型</span><i class="edit"></i></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="accountBuilder" style="display:none;">
                <a href="javascript:void(0);" class="btn-close"></a>
                <div class="accountBuilder-sidebar">
                    <ul>
                        <li data-specification-id="name1" data-specification-value="value1">
                            <a href="javascript:void(0);">
                                <span>衣身选择</span>
                                <span class="chosen">修身型</span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);">
                                <span>领型选择</span>
                                <span class="chosen">修身型</span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);">
                                <span>袖口选择</span>
                                <span class="chosen">修身型</span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);">
                                <span>口袋选择</span>
                                <span class="chosen">修身型</span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);">
                                <span>门襟选择</span>
                                <span class="chosen">修身型</span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);">
                                <span>褶皱选择</span>
                                <span class="chosen">修身型</span>
                            </a>
                        </li>
                        <li data-letters="123">
                            <a href="javascript:void(0);">
                                <span>绣花选择</span>
                                <span class="chosen">修身型</span>
                            </a>
                        </li>
                    </ul>
                    <p class="msg hidden"></p>
                    <a href="javascript:void(0);" class="button btn-save">保存并退出</a>
                    <a href="javascript:void(0);" class="reset">全部重置</a>
                </div>
                <div class="accountBuilder-content">
                    <div class="step normal" data-bg-img-change="true" style="display:block;" data-specification-id="name1" data-title="衣身" data-description="衣身描述">
                        <img class="bg-img right" src="img/product-customization-build3-0.jpg" />
                        <div class="message">
                            <h2>衣身</h2>
                            <p>这个简单的工具能够帮助你迅速了解并且建立属于自己的衬衫版型。在每一个衬衫细节选择你喜欢的选项，然后点击下一步即可。保证每个细节都按照你的设想与喜好，一切就绪之后就可以把这件衬衫添加到购物车了。</p>
                        </div>
                        <div class="options">
                            <div class="option active" data-specification-value="value1" data-title="直筒型" data-description="直筒型描述">
                                <div class="image"><img src="img/product-customization-build3-0.jpg" /></div>
                                <div class="text">直筒型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-1.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                        </div>
                    </div>
                    <div class="step normal" data-bg-img-change="true" style="display:block;">
                        <img class="bg-img right" src="img/product-customization-build3-0.jpg" />
                        <div class="message">
                            <h2>领口</h2>
                            <p>这个简单的工具能够帮助你迅速了解并且建立属于自己的衬衫版型。在每一个衬衫细节选择你喜欢的选项，然后点击下一步即可。保证每个细节都按照你的设想与喜好，一切就绪之后就可以把这件衬衫添加到购物车了。</p>
                        </div>
                        <div class="options">
                            <div class="option active">
                                <div class="image"><img src="img/product-customization-build3-0.jpg" /></div>
                                <div class="text">直筒型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-1.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-2.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-3.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-4.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                        </div>
                    </div>
                    <div class="step normal" data-bg-img-change="true" style="display:block;">
                        <img class="bg-img right" src="img/product-customization-build3-0.jpg" />
                        <div class="message">
                            <h2>袖口</h2>
                            <p>这个简单的工具能够帮助你迅速了解并且建立属于自己的衬衫版型。在每一个衬衫细节选择你喜欢的选项，然后点击下一步即可。保证每个细节都按照你的设想与喜好，一切就绪之后就可以把这件衬衫添加到购物车了。</p>
                        </div>
                        <div class="options">
                            <div class="option active">
                                <div class="image"><img src="img/product-customization-build3-0.jpg" /></div>
                                <div class="text">直筒型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-1.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-2.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-3.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-4.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                        </div>
                    </div>
                    <div class="step normal" data-bg-img-change="true" style="display:block;">
                        <img class="bg-img right" src="img/product-customization-build3-0.jpg" />
                        <div class="message">
                            <h2>口袋</h2>
                            <p>这个简单的工具能够帮助你迅速了解并且建立属于自己的衬衫版型。在每一个衬衫细节选择你喜欢的选项，然后点击下一步即可。保证每个细节都按照你的设想与喜好，一切就绪之后就可以把这件衬衫添加到购物车了。</p>
                        </div>
                        <div class="options">
                            <div class="option active">
                                <div class="image"><img src="img/product-customization-build3-0.jpg" /></div>
                                <div class="text">直筒型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-1.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-2.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-3.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-4.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                        </div>
                    </div>
                    <div class="step normal" data-bg-img-change="true" style="display:block;">
                        <img class="bg-img right" src="img/product-customization-build3-0.jpg" />
                        <div class="message">
                            <h2>门襟</h2>
                            <p>这个简单的工具能够帮助你迅速了解并且建立属于自己的衬衫版型。在每一个衬衫细节选择你喜欢的选项，然后点击下一步即可。保证每个细节都按照你的设想与喜好，一切就绪之后就可以把这件衬衫添加到购物车了。</p>
                        </div>
                        <div class="options">
                            <div class="option active">
                                <div class="image"><img src="img/product-customization-build3-0.jpg" /></div>
                                <div class="text">直筒型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-1.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-2.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-3.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-4.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                        </div>
                    </div>
                    <div class="step normal" data-bg-img-change="true" style="display:block;">
                        <img class="bg-img right" src="img/product-customization-build3-0.jpg" />
                        <div class="message">
                            <h2>褶皱</h2>
                            <p>这个简单的工具能够帮助你迅速了解并且建立属于自己的衬衫版型。在每一个衬衫细节选择你喜欢的选项，然后点击下一步即可。保证每个细节都按照你的设想与喜好，一切就绪之后就可以把这件衬衫添加到购物车了。</p>
                        </div>
                        <div class="options">
                            <div class="option active">
                                <div class="image"><img src="img/product-customization-build3-0.jpg" /></div>
                                <div class="text">直筒型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-1.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-2.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-3.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                            <div class="option">
                                <div class="image"><img src="img/product-customization-build3-4.jpg" /></div>
                                <div class="text">修身型</div>
                            </div>
                        </div>
                    </div>
                    <div class="step normal" data-bg-img-change="true" style="display:block;">
                        <img class="bg-img right" src="img/product-customization-build3-0.jpg" />
                        <div class="message">
                            <h2>刺绣</h2>
                            <p>这个简单的工具能够帮助你迅速了解并且建立属于自己的衬衫版型。在每一个衬衫细节选择你喜欢的选项，然后点击下一步即可。保证每个细节都按照你的设想与喜好，一切就绪之后就可以把这件衬衫添加到购物车了。</p>
                        </div>
                        <div class="options">
                            <div class="option active" data-monogram-value="custom">
                                <div class="image"><img src="img/product-customizztion-letters.jpg" /></div>
                                <div class="text">自定义</div>
                            </div>
                            <div class="option" data-monogram-value="none">
                                <div class="image"><img src="img/product-customizztion-letters-none.jpg" /></div>
                                <div class="text">无刺绣</div>
                            </div>
                            <div class="option-monogram">
                                <input class="monogram" type="text" value="" />
                                <input class="monogram second" type="text" value="" />
                                <input class="monogram third" type="text" value="" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <div class="contact">
            <h3 class="hide-on-small">与凡布保持联系</h3>
            <div class="input-group hide-on-small">
                <input class="input" type="text" placeholder="请输入您的邮件地址" />
                <a href="javascript:void(0);" class="btn">»</a>
            </div>
            <div class="ico-link text-center-on-small">
                <a href="javascript:void(0);"><img src="img/ico-email.jpg" /></a>
                <a href="javascript:void(0);"><img src="img/ico-weibo.png" /></a>
                <a href="javascript:void(0);"><img src="img/ico-weixin.png" /></a>
                <a href="javascript:void(0);"><img src="img/ico-taobao.png" /></a>
            </div>
        </div>
        <div class="links text-center-on-small">
            <div class="row">
                <div class="col-md-3 col-sm-12">
                    <h6>FabriTailor.com</h6>
                    <ul>
                        <li>
                            <a href="javascript:void(0);">
                                北京市<br />
                                朝阳区<br />
                                夏家园18号楼<br />
                                2091室
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="col-md-3 col-sm-12">
                    <h6>凡布制衣</h6>
                    <ul>
                        <li><a href="javascript:void(0);">关于我们</a></li>
                        <li><a href="javascript:void(0);">人才招聘</a></li>
                        <li><a href="javascript:void(0);">成为凡布量体师</a></li>
                        <li><a href="javascript:void(0);">服务条款</a></li>
                        <li><a href="javascript:void(0);">隐私声明</a></li>
                    </ul>
                </div>
                <div class="col-md-3 col-sm-12">
                    <h6>帮助</h6>
                    <ul>
                        <li><a href="javascript:void(0);">购物指南</a></li>
                        <li><a href="javascript:void(0);">关于量体定制</a></li>
                        <li><a href="javascript:void(0);">常见问题解答</a></li>
                        <li><a href="javascript:void(0);">帮助与支持</a></li>
                        <li><a href="javascript:void(0);">退换货信息</a></li>
                    </ul>
                </div>
                <div class="col-md-3 col-sm-12">
                    <h6>在线商店</h6>
                    <ul>
                        <li><a href="javascript:void(0);">衬衫</a></li>
                        <li><a href="javascript:void(0);">查看全部</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="logo">
            <img src="img/logo-footer.png" />
        </div>
    </footer>
    <div class="login-panel">
        <h2>登录</h2>
        <input class="input" type="text" placeholder="请输入电子邮件地址" />
        <input class="input" type="password" placeholder="请输入密码" />
        <a class="button" href="javascript:void(0);">登陆</a>
        <a href="javascript:void(0);">忘记密码，或立即免费注册成为会员？</a>
    </div>
    <div class="cover-small-black"></div>
    <div class="login-cover-black"></div>
    <script type="text/javascript">
        //侧边栏
        $("header .menu-btn").click(function () {
            $("aside").addClass("opened");
            $("div.cover-small-black").addClass("opened").fadeTo("normal", 0.5, EASING_NAME);
        });
        $("aside .btn-close").click(function () {
            $("aside").removeClass("opened");
            $("div.cover-small-black").fadeTo("normal", 0, EASING_NAME, function () { $(this).removeClass("opened"); });
        });
        //登陆
        var showLogin = function () {
            $(".login-panel").show();
            $("div.login-cover-black").addClass("opened").fadeTo("normal", 0.5, EASING_NAME);
        };
        var hideLogin = function () {
            $(".login-panel").hide();
            $("div.login-cover-black").fadeTo("normal", 0, EASING_NAME, function () { $(this).removeClass("opened"); });
        };
        $("div.login-cover-black").click(hideLogin);
        $("header .btn-group .login").click(showLogin);
    </script>
    <script type="text/javascript">
        //账号导航菜单
        $(".main-container .account-aside .current i.showhide").click(function () {
            $(this).toggleClass("mins");
            $(".main-container .account-aside ul").toggleClass("opened");
        });
    </script>
    <script type="text/javascript">
        var accountBuildOptions = $(".accountBuild .customization .options"),
            accountBuilder = $(".accountBuilder"),
            accountBuilderSidebar = $(".accountBuilder .accountBuilder-sidebar"),
            accountBuilderContent = $(".accountBuilder .accountBuilder-content");
        //版型编辑界面
        var showAccountBuild = function (index) {
            if (typeof index !== "number")
                index = parseInt(index, 10);
            if (index < 0 || accountBuilder.hasClass("loading")
                || accountBuilderContent.children("div.step").length <= index
                || accountBuilderSidebar.find("ul li").eq(index).hasClass("active")) {
                return;
            }
            accountBuilderContent.children("div.step").hide().eq(index).show();
            accountBuilderSidebar.find("ul li").removeClass("active").eq(index).addClass("active");
            if (!accountBuilder.hasClass("opened")) {
                accountBuilder.addClass("loading opened").fadeTo("normal", 1, EASING_NAME, function () { $(this).removeClass("loading"); });
                $("body").addClass("noscroll");
            }
        };
        var hideAccountBuild = function () {
            accountBuilder.removeClass("opened").fadeTo("normal", 0, EASING_NAME, function () { $(this).hide(); $("body").removeClass("noscroll"); });
            accountBuilderSidebar.find("ul li").removeClass("active");
        };
        //选择版型
        var accountBuildOptionSelect = function () {
            var $option = $(this),
                $step = $(this).parent().parent();
            $step.find(".options .option").removeClass("active");
            $(this).addClass("active");
            if ($step.data("bg-img-change") && $(window).width() > 1040) {
                var src = $(this).find(".image img").attr("src");
                $bgImg = $step.children(".bg-img");
                if ($bgImg.attr("src") != src) {
                    var $newImg = $('<img class="bg-img" />');
                    if ($bgImg.hasClass("right"))
                        $newImg.addClass("right");
                    $newImg.css({ opacity: 0 }).attr("src", src);
                    $bgImg.fadeTo("normal", 0, EASING_NAME, function () { $(this).remove(); }).after($newImg);
                    $newImg.fadeTo("normal", 1, EASING_NAME);
                }
            }
            if ($option.data("title")) {
                $step.find(".message h2").text($option.data("title"));
                $step.find(".message p").text($option.data("description") || "");
            }
            if ($step.data("specification-id") && $option.data("specification-value")) {
                accountBuilderSidebar.find("ul li").each(function (i, e) {
                    var $li = $(e);
                    if ($li.data("specification-id") == $step.data("specification-id")) {
                        $li.data("specification-value", $option.data("specification-value"));
                        $li.find("a span.chosen").text($option.children(".text").text());
                        return false;
                    }
                });
            }
            if ($option.data("monogram-value")) {
                if ($option.data("monogram-value") == "none") {
                    accountBuilderSidebar.find("ul li").last().removeData("letters").removeAttr("data-letters");
                    accountBuilderSidebar.find("ul li").last().find("a span.chosen").text("无绣字");
                }
                else {
                    accountBuildMonogramChange();
                }
            }
        };
        //全部重置
        var accountBuildOptionReset = function () {
            accountBuilderContent.children("div.step").each(function (i, e) {
                var $step = $(e);
                if ($step.find(".options .option-monogram").length) {
                    accountBuildOptionSelect.call($step.find(".options .option").get(1));
                }
                else {
                    $step.removeData("specification-value").removeAttr("data-specification-value").find(".options .option").removeClass("active");
                    accountBuilderSidebar.find("ul li[data-specification-id=" + $step.data("specification-id") + "]").removeData("specification-value").removeAttr("data-specification-value").find("a span.chosen").text("无");
                }
                if ($step.data("title")) {
                    $step.find(".message h2").text($step.data("title"));
                    $step.find(".message p").text($step.data("description") || "");
                }
            });
        };
        //修改绣字
        var accountBuildMonogramKeydown = function (e) {
            if (e && e.keyCode != 8 && e.keyCode != 46
                && e.keyCode < 38 && e.keyCode > 40
                && $(this).val() && $(this).val().length) {
                return false;
            }
        };
        var accountBuildMonogramKeyup = function (e) {
            if (e && $(this).val() && $(this).val().length > 1) {
                $(this).val($(this).val().substring(0, 1));
            }
        };
        var accountBuildMonogramChange = function () {
            if (accountBuilderContent.children(".step").last().find(".options .option[data-monogram-value=none]").hasClass("active"))
                return;
            var letters = "";
            accountBuilderContent.children(".step").last().find(".options .option-monogram input").each(function (i, e) {
                if ($(e).val() && $(e).val().length)
                    letters += $(e).val();
            });
            if (letters.length) {
                accountBuilderSidebar.find("ul li").last().data("letters", letters);
                accountBuilderSidebar.find("ul li").last().find("a span.chosen").text("自定义(" + letters + ")");
            }
            else {
                accountBuilderSidebar.find("ul li").last().removeData("letters").removeAttr("data-letters");
                accountBuilderSidebar.find("ul li").last().find("a span.chosen").text("无绣字");
            }
        };
        //保存版型
        var saveAccountBuild = function () {
            var $btnSave = $(this);
            if ($btnSave.hasClass("disalbed"))
                return;
            accountBuilderSidebar.children("p.msg").addClass("hidden");
            var params = { specificationIds: [] },
                allSelected = true;
            accountBuilderSidebar.find("ul li").each(function (i, e) {
                var $li = $(e);
                if ($li.data("specification-id")) {
                    params.specificationIds.push($li.data("specification-id"));
                    if ($li.data("specification-value"))
                        params["specification_" + $li.data("specification-id")] = $li.data("specification-value");
                    else {
                        allSelected = false;
                        //return false;
                    }
                }
                if ($li.data("letters")) {
                    params.letters = $li.data("letters");
                }
            });
            //if (!allSelected) {
            //    $.alert.error("请选择所有定制项后再进行保存");
            //    return;
            //}
            $btnSave.addClass("disabled").text("正在保存...");
            $.ajax({
                url: "${base}/member/specification/save.jhtml",
                type: "POST",
                data: params,
                dataType: "json",
                cache: false,
                traditional: true,
                success: function (data) {
                    if (data && data.type == "success") {
                        //同步所选信息
                        accountBuilderContent.children(".step").each(function (i, e) {
                            var $step = $(e),
                                $option = $step.find(".options .option");
                            if ($step.data("specification-id")) {
                                var $optionSummary = accountBuildOptions.find(".option[data-specification-id=" + $step.data("specification-id") + "]");
                                if ($optionSummary.length) {
                                    if ($option.filter(".active").length) {
                                        $optionSummary.find(".image img").attr("src", $option.filter(".active").find(".image img").attr("src"));
                                        $optionSummary.find(".text span").text($option.filter(".active").find(".text").text());
                                    }
                                    else {
                                        $optionSummary.find(".image img").attr("src", $option.first().find(".image img").attr("src"));
                                        $optionSummary.find(".text span").text("无");
                                    }
                                }
                            }
                            if ($step.find(".options .option-monogram").length) {
                                var $optionSummary = accountBuildOptions.find(".option.monogram");
                                if ($optionSummary.length) {
                                    $optionSummary.find(".image img").attr("src", $option.find(".image img").attr("src"));
                                    $optionSummary.find(".text").text(accountBuilderSidebar.find("ul li").last().find("a span.chosen").text());
                                }
                            }
                        });
                        hideAccountBuild();
                        $.alert("保存成功");
                    }
                    else {
                        //accountBuilderSidebar.children("p.msg").removeClass("hidden").text("保存失败。" + data.content);
                        $.alert.error("保存失败。" + data.content);
                    }
                },
                error: function () {
                    //accountBuilderSidebar.children("p.msg").removeClass("hidden").text("保存失败。");
                    $.alert.error("保存失败。");
                }
            }).always(function () {
                $btnSave.removeClass("disabled").text("保存并退出");
            });
        };
        //注册事件
        if (isMobile()) {
            accountBuildOptions.find(".option").on({
                "touchstart": function () {
                    $(this).data("touchclick", true);
                },
                "touchmove": function () {
                    $(this).data("touchclick", false);
                },
                "touchend": function () {
                    if ($(this).data("touchclick"))
                        showAccountBuild($(this).prevAll(".option").length);
                }
            });
            accountBuilderSidebar.find("ul li a").on({
                "touchstart": function () {
                    $(this).data("touchclick", true);
                },
                "touchmove": function () {
                    $(this).data("touchclick", false);
                },
                "touchend": function () {
                    if ($(this).data("touchclick"))
                        showAccountBuild($(this).parent().prevAll().length);
                }
            });
            accountBuilderContent.find(".step .options .option").on("touchend", accountBuildOptionSelect);
            accountBuilder.find("a.btn-close").on("touchend", hideAccountBuild);
            accountBuilderSidebar.children("a.btn-save").on("touchend", saveAccountBuild);
            accountBuilderSidebar.children("a.reset").on("touchend", accountBuildOptionReset);
        }
        else {
            accountBuildOptions.find(".option").click(function () {
                showAccountBuild($(this).prevAll(".option").length);
            });
            accountBuilderSidebar.find("ul li a").click(function () {
                showAccountBuild($(this).parent().prevAll().length);
            });
            accountBuilderContent.find(".step .options .option").click(accountBuildOptionSelect);
            accountBuilder.find("a.btn-close").click(hideAccountBuild);
            accountBuilderSidebar.children("a.btn-save").click(saveAccountBuild);
            accountBuilderSidebar.children("a.reset").click(accountBuildOptionReset);
        }
        accountBuilderContent.children(".step").last().find(".options .option-monogram input")
                .keydown(accountBuildMonogramKeydown)
                .keyup(accountBuildMonogramKeyup)
                .change(accountBuildMonogramChange);
    </script>
</body>
</html>
